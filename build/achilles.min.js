function callMe(){something++,angular.element("html").scope().$broadcast("somethingChanged")}!function(){"use strict";angular.module("achilles",["ngResource","ngSanitize","ui.bootstrap","rt.select2","textAngular"])}(),function(){"use strict";function a(a){a.interceptors.push("SpinnerHttpInterceptor")}function b(a,b){var c={response:function(a){return a.config.spinner&&b(function(){$("#loading-overlay").css("display","none")},150),a},responseError:function(c){return c.config.spinner&&b(function(){$("#loading-overlay").css("display","none")},150),a.reject(c)},request:function(a){return"GET"==a.method&&a.spinner&&$("#loading-overlay").css("display","block"),a}};return c}angular.module("achilles").config(a).factory("SpinnerHttpInterceptor",b),a.$inject=["$httpProvider"],b.$inject=["$q","$timeout"]}(),function(){"use strict";function a(a){a.decorator("taOptions",["taRegisterTool","$delegate",function(a,b){return a("colorRed",{iconclass:"fa fa-square red-text",action:function(){this.$editor().wrapSelection("forecolor","red")}}),a("colorBlue",{iconclass:"fa fa-square blue-text",action:function(){this.$editor().wrapSelection("forecolor","blue")}}),a("colorOrange",{iconclass:"fa fa-square orange-text",action:function(){this.$editor().wrapSelection("forecolor","orange")}}),a("colorGreen",{iconclass:"fa fa-square green-text",action:function(){this.$editor().wrapSelection("forecolor","green")}}),a("colorBlack",{iconclass:"fa fa-square",action:function(){this.$editor().wrapSelection("forecolor","black")}}),a("colorGrey",{iconclass:"fa fa-square grey-text",action:function(){this.$editor().wrapSelection("forecolor","lightgrey")}}),b.toolbar=[["bold","italics","underline","colorRed","colorOrange","colorGreen","colorBlue","colorBlack","colorGrey","ul","ol","redo","undo","clear"]],b}])}angular.module("achilles").config(a),a.$inject=["$provide"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){a.get(b.treatmentList(achillesConfig.patient),{spinner:!0}).then(function(a){h.treatments=a.data})}function g(){c.get(achillesConfig.process).then(function(a){h.user=a})}var h=this;h.baseUrl=b.baseUrl(),h.entries=[],h.loadEntries=f,h.process=achillesConfig.process,h.patient=achillesConfig.patient,h.reverse=!1,h.marginOptions=[{"class":"large-margins",label:"Grosse Abstände"},{"class":"small-margins",label:"Kleine Abstände"}],h.fontSizes=[{"class":"large-fonts",label:"Gross"},{"class":"medium-fonts",label:"Mittel"},{"class":"small-fonts",label:"Klein"}],h.checkEditPermission=d.checkEditPermission,h.loadEntries(),g(),console.log("maincontroller line 32 ")}angular.module("achilles").controller("MainController",a),a.$inject=["$http","urls","User","TreatmentPermission","EntryType"]}(),function(){"use strict";function a(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("canceled")}}function b(a,b){a.presets=[{id:1,name:"SOAP"},{id:2,name:"Gynäkologische Untersuchung"},{id:3,name:"Vermicelles"},{id:4,name:"Schoggischuum"}],a.close=function(a){b.close(a)}}angular.module("achilles").controller("DeleteModalController",a).controller("PresetModalController",b),a.$inject=["$scope","$modalInstance"],b.$inject=["$scope","$modalInstance"]}(),function(){"use strict";function a(){function a(a,b,c){var d={};c.draggableHandle&&(d.handle=c.draggableHandle),b.draggable(d)}var b={restrict:"A",link:a};return b}angular.module("achilles").directive("draggable",a)}(),function(){"use strict";function a(a){function b(b,c,d){console.log(document.activeElement);var e=c.find("textarea");a(function(){console.log(document.activeElement),e.focus(),console.log("trying"),console.log(document.activeElement)},5e3),c.find("a").on("click",function(){console.log("focus"),e.select2("open")})}var c={link:b};return c}angular.module("achilles").directive("modalSelect2",a),a.$inject=["$timeout"]}(),function(){"use strict";function a(){var a={restrict:"E",controller:b,controllerAs:"dc",scope:{},templateUrl:"../js/templates/textblock-widget.tpl.html"};return a}function b(a,b,c,d,e){function f(b){b&&(i.textGroups=a("filter")(h,{treatmentEntryType:b.id}),i.selectedGroup={})}function g(a){var c="";if(!angular.isDefined(a))return void i.showWidget(!1);c=angular.isArray(a)?a.map(function(a){return a.text}).join(" "):a;var e=b.getCurrentlyFocusedColumn(),f=b.getCurrentlyFocusedRow(),g=b.getCurrentlyFocusedEntry();e&&g&&(e.content+=c,d.save(f,g)),i.showWidget(!1)}var h,i=this;i.insertSelection=g,i.isVisible=c.isVisible,i.showWidget=c.show,c.addObserverCallback(f),e.all().then(function(a){i.textGroups=h=a})}angular.module("achilles").directive("textBlockWidget",a),b.$inject=["$filter","CurrentFocus","TextBlockWidget","TreatmentRow","TextBlock"]}(),function(){"use strict";function a(){function a(a,b,c){c.$observe("show",function(){console.log("changed",c.show),a.showWidget=a.$eval(c.show)})}var c={restrict:"E",controller:b,controllerAs:"dc",link:a,scope:{showWidget:"="},templateUrl:"../js/templates/title-settings-widget.tpl.html"};return c}function b(a,b,c,d){function e(a,b){a.forEach(function(a){c.changeVisibility(a,h.user,b)})}function f(b,d,e){if(e.altKey){var f=a("filter")(h.entryTypes,function(a){return a!==b&&!a.hidden}).length>0;h.entryTypes.forEach(function(a){b!==a&&c.changeVisibility(a,h.user,!f)}),c.changeVisibility(b,h.user,!0)}else c.changeVisibility(b,h.user,d)}function g(){c.get(achillesConfig.process).then(function(a){h.user=a,b.all().then(function(b){c.setVisibleEntryTypes(b,a),h.entryTypes=b})})}var h=this;h.changeTypeStatus=f,h.changeAll=e,h.isVisible=d.getTitleSettingsWidgetVisibility,h.showWidget=d.showTitleSettingsWidget,g()}angular.module("achilles").directive("titleSettingsWidget",a),a.$inject=["$timeout"],b.$inject=["$filter","EntryType","User","WidgetVisibility"]}(),function(){"use strict";function a(a){function b(b,c,d,e){c.on("click",function(){e.isOpen()&&a(function(){c.find("li a").eq(0).focus()},150)}),c.on("keydown","li a",function(a){if(40==a.which){a.preventDefault();var b=$(this).parent().nextAll(":visible:not(.divider)").first().find("a"),c=$(this).parent().siblings().first().find("a");b.length?b.focus():c.focus()}if(38==a.which){a.preventDefault();var d=$(this).parent().prevAll(":visible:not(.divider)").first().find("a"),e=$(this).parent().siblings().last().find("a");d.length?d.focus():e.focus()}})}var c={require:"dropdown",link:b};return c}angular.module("achilles").directive("toggleFocus",a),a.$inject=["$timeout"]}(),function(){"use strict";function a(a,c,d,e,f,g,h,i){function j(a){return"true"==a?m.editable:m.readonly}function k(a,b,c,k){function m(c){b.html(j(c)).show(),e(b.contents())(a)}function n(b){angular.element(this).hasClass("ng-dirty")&&!a.row.locked&&i.save(a.row,a.entry),d(function(){a.entry.focused=!1},150),d.cancel(l)}function o(c){if(a.row.locked&&w(c))c.preventDefault();else if(c.ctrlKey&&c.shiftKey&&8==c.which){var e=b.parents(".row").prev().find("textarea:not(:disabled)"),f=b.parents(".row").next().find("textarea:not(:disabled)"),j=b.parents("treatment-entry").prev().find("textarea:not(:disabled)"),k=b.parents("treatment-entry").next().find("textarea:not(:disabled)");d(function(){e.length?e.eq(0).focus():j.length?j.eq(0).focus():f.length?f.eq(0).focus():k.eq(0).focus()},150),x.removeRow(a.row)}else c.ctrlKey&&13==c.which?(i.save(a.row,a.entry),h.addEntry(a.treatment.id,a.entry.type,a.treatment.entries)):!a.row.hasOwnLock&&w(c)&&g.lock(a.row)}function p(a){console.log("index",$(this).index()),console.log("text",$(this).text()),console.log("html",$(this).html());var c=(document.createRange(),window.getSelection());console.log("offset",c.focusOffset),console.log("toString",c.toString()),console.log(c);var d=b.find(".ta-bind:not(.ta-readonly)"),e=t(d);console.log("nodes",e)}function q(b){f.setCurrentFocus(a.column,a.row,a.entry),f.clearNewFocus(),a.warning&&!a.warning.displayed&&(toastr.warning(a.warning.message),a.warning.displayed=!0),l=d(function(){g.check(a.row)},450),d(function(){a.entry.focused=!0},250)}function r(b){a.readonly()&&a.warning&&!a.warning.displayed&&(toastr.error(a.warning.message),a.warning.displayed=!0)}function s(a){if(!a.length)return null;var b=a[0];return u(b)}function t(a){if(!a.length)return null;var b=a[0],c=[];return v(b,c),c}function u(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(3==c.nodeType){if(c.nodeValue.indexOf("*")>=0)return c}else{var d=u(c);if(d)return d}}return null}function v(a,b){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(3==d.nodeType)d.nodeValue.indexOf("*")>=0&&b.push(d);else{var e=v(d,b);e&&b.push(e)}}}function w(a){return!(9==a.which||a.which>=37&&a.which<=40||a.ctrlKey&&65==a.which||a.ctrlKey&&67==a.which)}var x=(k[0],k[1]);a.columnClass="col-xs-"+c.width,b.on("blur",".ta-bind",n),b.on("keydown",".ta-bind",o),b.on("focus",".ta-bind",q),b.on("click",".ta-bind",r),b.on("keyup",".ta-bind",p),c.$observe("editable",m),m(c.editable),a.$watch(f.getNewlyFocusedRow,function(c){if(console.log("currentfocus changed"),c&&a.row.id==c.id){var d=b.find(".ta-bind:not(.ta-readonly)");d.eq(0).focus();var e=s(d);if(e){var f=document.createRange(),g=e.nodeValue.indexOf("*");f.setStart(e,g),f.setEnd(e,g+1);var h=window.getSelection();h.removeAllRanges(),h.addRange(f)}}})}var l,m={editable:'<div ng-class="columnClass"><div class="form-group"><div ng-model="content" ta-disabled="readonly()" text-angular ta-target-toolbars="toolbar-{{treatment.id}}-{{type.id}}"></div></div></div>',readonly:'<div ng-class="columnClass"><p ng-bind-html="readonlyContent" class="read-only-content"></p></div>'},n={restrict:"E",scope:{width:"@",column:"=",content:"=",readonly:"&",row:"=",uniqueId:"@",treatment:"=",warning:"=",type:"=",entry:"="},require:["^treatment","^treatmentEntry"],controller:b,link:k};return n}function b(a,b){a.readonlyContent=b.trustAsHtml(a.content)}angular.module("achilles").directive("treatmentColumn",a),a.$inject=["$http","urls","$timeout","$compile","CurrentFocus","Locking","Treatment","TreatmentRow"],b.$inject=["$scope","$sce"]}(),function(){"use strict";function a(){function a(a,b,c,d){a.removeEntry=d.removeEntry}var c={scope:{entry:"=",editable:"@",treatment:"=",permissionToEdit:"&",warning:"="},restrict:"E",templateUrl:"../js/templates/treatment-entry.tpl.html",require:"^treatment",controller:b,controllerAs:"dc",link:a};return c}function b(a,b,c,d,e){function f(a){return k.user.hiddenEntryTypes&&k.user.hiddenEntryTypes.indexOf(a.id)>-1}function g(){d.get(achillesConfig.process).then(function(a){k.user=a})}function h(b){a.entry.focused=b}function i(){a.entryform.$setPristine()}function j(d){var e=a.entry.rows;b.post(c.treatmentEntryRow("delete")+d.id).then(function(){for(var b=0;b<e.length;b++)if(e[b].id==d.id){e.splice(b,1);break}0===e.length&&a.removeEntry(a.entry)})}var k=this;k.isHidden=f,k.makePristine=i,k.removeRow=j,k.setEntryFocus=h,k.showTextBlockWidget=e.show,k.user={},g()}angular.module("achilles").directive("treatmentEntry",a),b.$inject=["$scope","$http","urls","User","TextBlockWidget"]}(),function(){"use strict";function a(a){function b(b,c){function d(){a(function(){var a=c.find(".ta-bind:not(.ta-readonly)").eq(0);a.focus()},150)}b.$watch("row.changed",function(a){a&&d()}),b.row["new"]===!0&&d()}var c={link:b};return c}angular.module("achilles").directive("treatmentRow",a),a.$inject=["$timeout"]}(),function(){"use strict";function a(){var a={restrict:"E",controller:b,controllerAs:"toolbar",templateUrl:"../js/templates/treatment-toolbar.tpl.html"};return a}function b(a,b,c,d,e,f){function g(a){console.log("getting here");var c=a.length?b("orderBy")(a,["-date","id"])[0]:{id:0};d.addTreatment(c,!0,!0,a)}function h(a){var c,d,f,g,h=[];c=e.getCurrentlyFocusedRow(),console.log("currentlyFocusedRow",c),a.forEach(function(a){if("true"===a.editable||a.editable===!0){var c=b("orderBy")(a.entries,"type.name");c.forEach(function(a){a.rows.forEach(function(a){h.push(a)})})}}),c?(console.log("here"),f=h.slice(h.indexOf(c)+1)):f=h,g=b("filter")(f,{$:"*"}),0===g.length&&(g=b("filter")(h,{$:"*"})),d=g.shift(),d&&(console.log(d),e.setNewFocus(d))}function i(b){a.get(c.biometricReport(b))}function j(b){a.get(c.laboratoryReport(b))}function k(b,d){var e=[];d.forEach(function(a){console.log(a);var b={id:a.id,rows:[]};a.entries.forEach(function(a){a.rows.forEach(function(a){b.rows.push(a.id)})}),e.push(b)}),a.post(c.treatmentReport(b),e)}function l(b,d,e){a.post(c.executeGDT(b,d,e)).then(function(){console.log("that worked")})["catch"](function(){console.log("that didn't")})}function m(){a.get(c.gdtList()).then(function(a){n.gdtDevices=a.data})}var n=this;n.addTreatment=g,n.asteriskSearch=h,n.openBiometricReport=i,n.openLaboratoryReport=j,n.openTreatmentReport=k,n.executeGDT=l,n.showTitleSettingsWidget=f.showTitleSettingsWidget,m()}angular.module("achilles").directive("treatmentToolbar",a),b.$inject=["$http","$filter","urls","Treatment","CurrentFocus","WidgetVisibility"]}(),function(){"use strict";function a(a){function c(b,c,d,e){var f;b.treatment.editable=b.editable,c.on("keydown",function(a){120==a.which&&e.permissionToEdit&&c.find(".type-and-preset-search").focus(),121==a.which&&e.testModal()}),c.on("focusin",function(){a(function(){b.treatment.focused=!0,b.editable=!0,b.treatment.editable=!0}),a.cancel(f)}),c.on("focusout",function(){f=a(function(){b.treatment.focused=!1},300)}),c.on("select2-open",function(){b.select2Open=!0}),c.on("select2-blur",function(){b.select2Open=!1})}var d={scope:{treatment:"=",treatments:"=treatmentlist",editable:"@",user:"="},restrict:"E",controller:b,controllerAs:"dc",templateUrl:"../js/templates/treatment.tpl.html",link:c};return d}function b(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b,c,d){console.log("addEntry"),g.addEntry(b,c,d).then(function(){console.log("active false"),a.active=!1})}function o(b){for(var c=a.treatment.entries,d=0;d<c.length;d++)if(b.type.id==c[d].type.id){c.splice(d,1);break}}function p(a){a&&!t.documents&&i.list(u).then(function(a){t.documents=a},function(a){console.error(a.statusText),t.documents=[]})}function q(a){a&&!t.laboratoryReports&&j.list(u).then(function(a){t.laboratoryReports=a},function(){})}function r(a){a&&!t.biometrics&&k.list(u).then(function(a){t.biometrics=a},function(){})}function s(a){a&&!t.disabilityCertificates&&l.list(u).then(function(a){t.disabilityCertificates=a},function(){})}var t=this,u=a.treatment.id;t.newEntry={type:null},d.all().then(function(a){t.types=a}),h.all().then(function(a){t.subjects=a}),m.all().then(function(a){t.presets=a}),t.loadDocuments=p,t.loadLaboratoryReports=q,t.loadBiometrics=r,t.loadDisability=s,t.addEntry=n,t.addPreset=g.addPreset,t.baseUrl=c.baseUrl(),t.addTreatment=g.addTreatment,t.copyTreatment=g.copyTreatment,t.deleteTreatment=g.deleteTreatment,t.changeStatus=g.changeStatus,t.changeSubject=g.changeSubject,t.removeCase=g.removeCase,t.warning={},t.permissionToEdit=!1,t.removeEntry=o,f.get().then(function(b){t.warning=e.shouldBeWarned(b,a.treatment),t.permissionToEdit=e.checkEditPermission(b,a.treatment)})}angular.module("achilles").directive("treatment",a),a.$inject=["$timeout"],b.$inject=["$scope","$modal","urls","EntryType","TreatmentPermission","User","Treatment","Subject","Document","LaboratoryReport","Biometric","DisabilityCertificate","Preset"]}(),function(){"use strict";function a(a){function b(b,c,d){function e(){console.log("setting active"),a(function(){b.active=!0})}function f(){console.log("setting inactive"),a(function(){b.active=!1})}function g(d){function e(){c.find(".list-group-item:visible").first().addClass("focused")}function f(){c.find(".list-group-item:visible").last().addClass("focused")}var g=c.find(".list-group-item.focused");if(8==d.which||d.which>40)a(function(){g.removeClass("focused"),b.search.term>""&&e()},50);else if(40==d.which)if(d.preventDefault(),g.length){var h=g.nextAll(".list-group-item:visible").first();g.removeClass("focused"),h.addClass("focused")}else e();else if(38==d.which)if(d.preventDefault(),g.length){var i=g.prevAll(".list-group-item:visible").first();g.removeClass("focused"),i.addClass("focused")}else f();else 13==d.which&&g.click()}c.on("focusin",e),c.on("blur",f),c.find(".type-and-preset-search").on("keyup",g)}var c={restrict:"A",link:b};return c}angular.module("achilles").directive("typeAndPreset",a),a.$inject=["$timeout"]}();var something=0;toastr.options={positionClass:"toast-top-full-width"},function(){"use strict";function a(a,b){function c(c){return a.get(b.biometricList(c),{spinner:!0}).then(function(a){return a.data})}var d={list:c};return d}angular.module("achilles").service("Biometric",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(){function a(){return i}function b(){return j}function c(){return h}function d(){return k}function e(a,b,c){i=a,h=b,j=c}function f(){k=null}function g(a){k=a}var h,i,j,k,l={clearNewFocus:f,getCurrentlyFocusedColumn:a,getCurrentlyFocusedEntry:b,setCurrentFocus:e,getCurrentlyFocusedRow:c,setNewFocus:g,getNewlyFocusedRow:d};return l}angular.module("achilles").factory("CurrentFocus",a)}(),function(){"use strict";function a(a,b){function c(c){return a.get(b.disabilityList(c),{spinner:!0}).then(function(a){return a.data})}var d={list:c};return d}angular.module("achilles").service("DisabilityCertificate",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(a,b){function c(c){return a.get(b.documentList(c),{spinner:!0}).then(function(a){return a.data})}var d={list:c};return d}angular.module("achilles").service("Document",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(a,b,c){function d(){var d=b.defer();return f.length?d.resolve(f):g?h.push(d):(g=!0,a.get(c.treatmentEntryTypeList()).then(function(a){f=a.data;for(var b=0;b<f.length;b++)f[b].toString=function(){return this.id};g=!1,d.resolve(f),h.forEach(function(a){a.resolve(f)})})),d.promise}var e={all:d},f=[],g=!1,h=[];return e}angular.module("achilles").factory("EntryType",a),a.$inject=["$http","$q","urls"]}(),function(){"use strict";function a(a,b){function c(c){return a.get(b.laboratoryList(c),{spinner:!0}).then(function(a){return a.data})}var d={list:c};return d}angular.module("achilles").service("LaboratoryReport",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(a,b){function c(c){a.get(b.lock(c,achillesConfig.process)).then(function(a){var b=a.data;b.lock?(c.locked=!0,c.lockedBy=b.lockedBy):(c.locked=!1,b.row.lastChange>c.lastChange?(c.columns=b.row.columns,c["new"]=b.row["new"],c.changed=!0,c.lastChange=b.row.lastChange):0===b.row.id&&(c.id=0,c.deleted=!0))})}function d(c){var d={method:"POST",url:b.lock(c,achillesConfig.process,"put"),headers:{"Content-Type":"text/plain"}};a(d).then(function(a){204==a.status?c.hasOwnLock=!0:(c.lock=!0,c.lockedBy=a.data.lockedBy)})}var e={check:c,lock:d};return e}angular.module("achilles").factory("Locking",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(a,b,c){function d(){var d=b.defer();return f.length?d.resolve(f):g?h.push(d):(g=!0,a.get(c.presetList()).then(function(a){f=a.data;for(var b=0;b<f.length;b++)f[b].toString=function(){return this.id};g=!1,d.resolve(f),h.forEach(function(a){a.resolve(f)})})),d.promise}var e={all:d},f=[],g=!1,h=[];return e}angular.module("achilles").factory("Preset",a),a.$inject=["$http","$q","urls"]}(),function(){"use strict";function a(a,b,c){function d(){var d=b.defer();return f.length?d.resolve(f):g?h.push(d):(g=!0,a.get(c.treatmentSubject()).then(function(a){f=a.data,g=!1,d.resolve(f),h.forEach(function(a){a.resolve(f)})})),d.promise}var e={all:d},f=[],g=!1,h=[];return e}angular.module("achilles").service("Subject",a),a.$inject=["$http","$q","urls"]}(),function(){"use strict";function a(){function a(a){h.push(a)}function b(){return f}function c(){return g}function d(){h.forEach(function(a){a(f)})}function e(a,b){f=a?b:void 0,g=a,d()}var f,g=!1,h=[],i={addObserverCallback:a,isVisible:c,getType:b,show:e};return i}angular.module("achilles").factory("TextBlockWidget",a)}(),function(){"use strict";function a(a,b,c){function d(){var d=b.defer();return f.length?d.resolve(f):g?h.push(d):(g=!0,a.get(c.textblock(achillesConfig.process)).then(function(a){f=a.data;for(var b=0;b<f.length;b++)f[b].toString=function(){return this.id};g=!1,d.resolve(f),h.forEach(function(a){a.resolve(f)})})),d.promise}var e={all:d},f=[],g=!1,h=[];return e}angular.module("achilles").factory("TextBlock",a),a.$inject=["$http","$q","urls"]}(),function(){"use strict";function a(){function a(a,b){return("warn"==a.permission.modifyRange.mode||c-24*a.permission.modifyRange.pastDays*60*60*1e3<b.date&&c+24*a.permission.modifyRange.futureDays*60*60*1e3>b.date)&&(!b.isMandatorTreatment&&!a.isMandator||a.permission.editMandatorEntry&&(!a.isMandator||b.mandator==a.mandator.id))}function b(b,d){return a(b,d)?"warn"==b.permission.modifyRange.mode&&(c-24*b.permission.modifyRange.pastDays*60*60*1e3>d.date||c+24*b.permission.modifyRange.futureDays*60*60*1e3<d.date)?{displayed:!1,message:"Behandlungseintrag liegt ausserhalb des änderbaren Bereichs"}:!1:b.permission.editMandatorEntry?d.mandator!=b.mandator.id?{displayed:!1,message:"Nur der verantwortliche Mandant darf den Text ändern"}:void 0:{displayed:!1,message:"Sie verfügen nicht über die notwendigen Benutzerrechte um diese Aktion auszuführen"}}var c=Date.now(),d={checkEditPermission:a,shouldBeWarned:b};return d}angular.module("achilles").factory("TreatmentPermission",a)}(),function(){"use strict";function a(a,b){function c(c,d){a.post(b.treatmentEntryRow("put"),c).then(function(a){for(var b=a.data,c=d.rows,e=0;e<c.length;e++)if(c[e].id==b.id){c[e]=b;break}b.locked=!1,b.hasOwnLock=!1})}var d={save:c};return d}angular.module("achilles").factory("TreatmentRow",a),a.$inject=["$http","urls"]}(),function(){"use strict";function a(a,b,c,d){function e(b,e,f){return a.post(c.treatmentEntry(),{treatmentId:b,type:e}).then(function(a){for(var b=a.data,c=!1,g=0;g<f.length;g++)if(b.type.id==f[g].type.id){f[g]=b,c=!0;break}c||f.push(b),d.get().then(function(a){a.hiddenEntryTypes&&a.hiddenEntryTypes.indexOf(b.type.id)>-1&&d.changeVisibility(e,a)})})}function f(b,d,e){a.post(c.treatmentPreset(),{treatmentId:b,preset:d}).then(function(a){for(var c=a.data,d=0;d<e.length;d++)if(e[d].id==b){e[d]=c;break}})}function g(b,d,e,f){new Date;a.post(c.treatment(),{patient:achillesConfig.patient,process:achillesConfig.process,treatment:{id:b.id,isMandatorTreatment:d,isMainTreatment:e}}).then(function(a){f.push(a.data)})}function h(b,d){a.post(c.copyTreatment(),{process:achillesConfig.process,treatment:{id:b.id}}).then(function(a){d.push(a.data)})}function i(d,e){var f=b.open({templateUrl:"../js/templates/delete-modal.tpl.html",controller:"DeleteModalController",controllerAs:"mc",size:"sm"});f.result.then(function(){a.post(c.treatment("delete"),d).then(function(a){for(var b=0;b<e.length;b++)if(e[b].id==d.id){e.splice(b,1);break}})})}function j(b){b.closed=!b.closed,a.post(c.treatment("put"),b).then(function(a){b.closed=a.data.closed,console.log("treatment status changed")},function(a){b.closed=!b.closed})}function k(b,d){var e=b.subject;b.subject=d,a.post(c.treatment("put"),b).then(function(a){b.subject=a.data.subject},function(a){b.subject=e})}function l(b){var d=b.invoiceCase;b.invoiceCase={id:0,name:""},a.post(c.treatment("put"),b).then(function(a){b.invoiceCase=a.data.invoiceCase},function(){b.invoiceCase=d})}var m={addEntry:e,addPreset:f,addTreatment:g,copyTreatment:h,deleteTreatment:i,changeStatus:j,changeSubject:k,removeCase:l};return m}angular.module("achilles").factory("Treatment",a),a.$inject=["$http","$modal","urls","User"]}(),function(){"use strict";function a(){function a(){return y+z+":"+A+"/"}function b(b){return a()+B.caseList.replace(/:([a-z]\w*)/gi,b)+"/"}function c(b,c,d){var e="";return d&&(e=d+"/"),a()+e+B.lock.replace(/:row/,b.id).replace(/:process/,c)+"/"}function d(b,c,d){return a()+(d?B.executeGDTTest:B.executeGDT).replace(/:device/,b.id).replace(/:patient/,c).replace(/:test/,d?d.code:"")+"/"}function e(){return a()+B.presetList+"/"}function f(b){return a()+B.textblock.replace(/:process/,b)+"/"}function g(b){return a()+B.treatmentlist.replace(/:([a-z]\w*)/gi,b)+"/"}function h(){return a()+B.treatmententrytype+"/"}function i(){return a()+B.treatmententry+"/"}function j(b){var c="";return b&&(c=b+"/"),a()+c+B.treatmententryrow+"/"}function k(){return a()+B.treatmentpreset+"/"}function l(){return a()+B.treatmentsubject+"/"}function m(b){var c="";return b&&(c=b+"/"),a()+c+B.treatment+"/"}function n(){return a()+B.copyTreatment+"/"}function o(b){return a()+B.documentList.replace(/:([a-z]\w*)/gi,b)+"/"}function p(){return a()+B.gdtList+"/"}function q(b){return a()+B.laboratoryList.replace(/:([a-z]\w*)/gi,b)+"/"}function r(b){return a()+B.biometricList.replace(/:([a-z]\w*)/gi,b)+"/"}function s(b){return a()+B.disabilityList.replace(/:([a-z]\w*)/gi,b)+"/"}function t(b){return a()+B.removeCase.replace(/:treatment/gi,b.id).replace(/:case/gi,b.invoiceCase.id)+"/"}function u(b){return a()+B.biometricReport.replace(/:process/gi,b)+"/"}function v(b){return a()+B.laboratoryReport.replace(/:process/gi,b)+"/"}function w(b){return a()+B.treatmentReport.replace(/:process/gi,b)+"/"}function x(b,c){return a()+(c?c+"/":"")+B.user.replace(/:process/,b)+"/"}var y="http://",z=achillesConfig.baseUrl,A=achillesConfig.port,B={biometricList:"treatment/:treatment/biometriclist",biometricReport:"biometricreport/process/:process",caseList:"treatment/:treatment/caselist",copyTreatment:"treatment/copy",disabilityList:"treatment/:treatment/disabilitylist",documentList:"treatment/:treatment/documentlist",laboratoryList:"treatment/:treatment/laboratorylist",laboratoryReport:"laboratoryreport/process/:process",removeCase:"treatment/:treatment/case/:case",treatmententry:"treatmententry",treatmententryrow:"treatmententryrow",treatmententrytype:"treatmententrytype",treatmentpreset:"put/treatmentpreset",treatmentlist:"patient/:patient/treatmentlist",treatmentReport:"treatmentreport/process/:process",treatmentsubject:"treatmentsubject",treatment:"treatment",gdtList:"gdt/list",executeGDT:"gdt/:device/patient/:patient",executeGDTTest:"gdt/:device/patient/:patient/code/:test",lock:"treatmententryrow/lock/:row/process/:process",user:"user/process/:process",textblock:"textblock/process/:process",presetList:"treatmentpreset"},C={baseUrl:a,biometricList:r,biometricReport:u,caseList:b,copyTreatment:n,disabilityList:s,documentList:o,laboratoryList:q,laboratoryReport:v,removeCase:t,treatmentEntryTypeList:h,treatmentEntry:i,treatmentEntryRow:j,treatmentPreset:k,treatmentList:g,treatmentSubject:l,treatment:m,treatmentReport:w,gdtList:p,executeGDT:d,lock:c,user:x,textblock:f,presetList:e};return C}angular.module("achilles").factory("urls",a)}(),function(){"use strict";function a(a,b,c,d){function e(){var c=b.defer();return h?c.resolve(h):j?k.push(c):(j=!0,a.get(d.user(l)).then(function(a){h=a.data,j=!1,c.resolve(h),k.forEach(function(a){a.resolve(h)})})),c.promise}function f(a,b){a.forEach(function(a){b.hiddenEntryTypes.indexOf(a.id)>-1&&(a.hidden=!0)})}function g(b,e,f){e.hiddenEntryTypes||(e.hiddenEntryTypes=[]);var g=e.hiddenEntryTypes,h=g.indexOf(b.id);void 0!==f?(f&&h>-1&&g.splice(h,1),f||-1!==h||g.push(b.id),b.hidden=!f):h>-1?(g.splice(h,1),b.hidden=!1):(g.push(b.id),b.hidden=!0),i&&0===i.$$state.status&&c.cancel(i),i=c(function(){a.post(d.user(l,"put"),e)},150)}var h,i,j=!1,k=[],l=achillesConfig.process,m={get:e,setVisibleEntryTypes:f,changeVisibility:g};return m}angular.module("achilles").factory("User",a),a.$inject=["$http","$q","$timeout","urls"]}(),function(){"use strict";function a(){function a(){return c}function b(a){c=a}var c=!1,d={getTitleSettingsWidgetVisibility:a,showTitleSettingsWidget:b};return d}angular.module("achilles").factory("WidgetVisibility",a)}();
//# sourceMappingURL=achilles.min.js.map